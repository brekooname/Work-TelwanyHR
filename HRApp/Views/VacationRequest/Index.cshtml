@model IPagedList<HR_EmployeeAndVacationRequestDto>
<style>
    body {
        background-color: white;
    }
</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="~/assets/css/PagedList.css" />
@{
    ViewData["Title"] = "Vacation Request";
}

<h3 style="color:#0d6efd;"><i class="bi bi-list-ul" style="color:#0d6efd;"></i> طلبـات الاجـازه</h3>
<hr />


<section class="row">
    <div class="col-md-4">
        <form asp-action="filter">
            <div class="form-group">
                <label class="text-muted">اختر حاله الطلب</label>
                <select name="dropSelect" class="form-select">
                    <option   value="null">الطلب تحت المراجعه</option>
                    <option   value="true">تم الموافقه </option>
                    <option   value="false">تم الرفض</option>
                </select>

            </div>
            <div class="form-group">
                <div>
                    <label class="text-muted">من تاريخ</label>
                    <input type="date" class="form-control" name="FromDate">
                </div>
                <div>
                    <label class="text-muted">الى تاريخ</label>
                    <input type="date" class="form-control" name="ToDate">
                </div>
            </div>
            <br />
            <button type="submit" class="btn btn-primary"><i class="fa fa-search-alt"></i> ابحـث بحاله الطلـب و التاريخ</button>
        </form>
    </div>
</section>
<hr />

<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th scope="col">الاسم</th>
                <th scope="col">من تاريخ</th>
                <th scope="col">الي تاريخ</th>
                <th scope="col">عدد الايام</th>
                <th scope="col">حاله المراجعه</th>
                <th scope="col">تاريخ المراجعه</th>
                <th scope="col">ملاحظـات الموظف</th>
                <th scope="col">ملاحظـات الاداره</th>
                <th scope="col">تعديل طلب</th>
                <th scope="col">حذف طلب</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ToList<HR_EmployeeAndVacationRequestDto>())
            {
                <tr>
                    <td>@item.name</td>
                    <td>@item.fromDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.ToDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.DayCount</td>
                    @if (item.Closed == null)
                    {
                        <td>الطلب تحت المراجعه</td>
                    }
                    @if (item.Closed == true)
                    {
                        <td>تم الموافقه</td>

                    }
                    @if (item.Closed == false)
                    {
                        <td>تم الرفض</td>
                    }
                    <td>@item.CloseDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.Remarks1</td>
                    <td>@item.Remarks3</td>
                    <td><a style="font-size :smaller" asp-action="Edit" asp-route-VacRequestId="@item.VacRequestId" class="btn btn-outline-primary"><i class="fa fa-pencil-alt"></i></a></td>
                    <td><a style="font-size :smaller" asp-action="delete" asp-route-VacRequestId="@item.VacRequestId" class="btn btn-danger"><i class="fa fa-trash-alt"></i></a></td>
                </tr>
            }

        </tbody>
    </table>
    @Html.PagedListPager(Model, pageIndex => Url.Action("Index", new { pageIndex  }) )

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

@section Scripts  {
    <script>
        $(document).ready(function () {
            $('.js-delete').on('click', function () {
                var btn = $(this);

                var result = confirm("هل انت متاكد من انك تريد حذف طلب الاجازه ؟");

                if (result) {
                    $.ajax({
                        url: '/VacationRequest/delete/' + btn.data('empid'),
                        success: function () {
                            btn.parents('.table').fadeOut();
                            toastr.success('vacation deleted');
                        },
                        error: function () {
                            toastr.error('Something went wrong!');
                        }
                    });
                }



            });
        });

    </script>
    }



