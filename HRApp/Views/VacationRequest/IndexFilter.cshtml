@model IPagedList<HR_EmployeeAndVacationRequestDto>
<style>
    body {
        background-color: white;
    }
</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<link rel="stylesheet" href="~/assets/css/PagedList.css" />

<h3 style="color:#0d6efd;"> <i class="bi bi-blockquote-left"></i> تقرير طلبات الاجازات </h3>
<hr />
<a asp-action="index" class="btn btn-outline-secondary mt-2 mb-2"> <i class="bi bi-backspace-fill"></i> الرجوع الي قائمه الاجازات</a>


<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th scope="col">الاسم</th>
                <th scope="col">من تاريخ</th>
                <th scope="col">الي تاريخ</th>
                <th scope="col">عدد الايام</th>
                <th scope="col">حاله المراجعه</th>
                <th scope="col">تاريخ المراجعه</th>
                <th scope="col">ملاحظـات الموظف</th>
                <th scope="col">ملاحظـات الاداره</th>
                <th scope="col">تعديل طلب</th>
                <th scope="col">حذف طلب</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.ToList<HR_EmployeeAndVacationRequestDto>())
            {
                <tr class="rw">
                    <td>@item.name</td>
                    <td>@item.fromDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.ToDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.DayCount</td>
                    @if (item.Closed == null)
                    {
                        <td>الطلب تحت المراجعه</td>
                    }
                    @if (item.Closed == true)
                    {
                        <td>تم الموافقه</td>

                    }
                    @if (item.Closed == false)
                    {
                        <td>تم الرفض</td>
                    }
                    <td>@item.CloseDate.ToString("dd/MM/yyyy")</td>
                    <td>@item.Remarks1</td>
                    <td>@item.Remarks3</td>
                    <td><a style="font-size :smaller" asp-action="Edit" asp-route-VacRequestId="@item.VacRequestId" class="btn btn-outline-primary"><i class="fa fa-pencil-alt"></i></a></td>
                    <td><a style="font-size :smaller" href="javascript:;" class="btn btn-danger js-delete " data-id="@item.VacRequestId"><i class="fa fa-trash-alt"></i></a></td>
                </tr>
            }

        </tbody>

    </table>
    @Html.PagedListPager(Model, pageIndex => Url.Action("filter", new { pageIndex  }) )


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

    @section Scripts  {
        <script>
            $(document).ready(function () {
                $('.js-delete').on('click', function () {
                    var btn = $(this);
                    Swal.fire({
                        title: 'تأكيد الحذف',
                        text: 'هل أنت متأكد من رغبتك في حذف طلب الاجازه؟',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'نعم',
                        cancelButtonText: 'لا'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            $.ajax({
                                url: '/VacationRequest/delete/' + btn.data('id'),
                                success: function () {
                                    btn.parents('.rw').fadeOut();
                                    Swal.fire({
                                        title: 'تم الحذف بنجاح',
                                        text: 'تم حذف طلب الاجازة بنجاح!',
                                        icon: 'success'
                                    });
                                },
                                error: function () {
                                    Swal.fire({
                                        title: 'خطأ',
                                        text: 'حدث خطأ أثناء الحذف!',
                                        icon: 'error'
                                    });
                                }
                            });
                        }
                    });

                });
            });

        </script>
    }





